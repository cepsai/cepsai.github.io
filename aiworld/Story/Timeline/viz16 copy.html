<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Timeline 2025</title>
  
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">

  <style>
    html, body { 
      height: 100%; margin: 0; padding: 0; 
      overflow: hidden; background: #ffffff; 
      font-family: 'Lato', sans-serif;
    }
    
    .viz-grid { 
      display: grid; 
      grid-template-rows: 1fr auto; 
      height: 100vh; width: 100vw; 
      background: #ffffff;
    }
    
    #chart-container { 
      grid-row: 1; 
      position: relative; 
      width: 100%; height: 100%; 
      overflow: hidden;
    }

    svg { width: 100%; height: 100%; display: block; }

    /* Ensure the bar is white and elements are spaced to edges */
    .control-bar { 
    grid-row: 2; 
    display: flex; 
    align-items: center; 
    justify-content: space-between; /* Pushes source left and controls right */
    padding: 16px 32px;
    background: #ffffff; 
    border-top: none; 
    z-index: 10;
    }

    /* Container for Replay + Logos */
    .right-controls {
    display: flex;
    align-items: center;
    gap: 24px; /* Space between Replay button and Logos */
    }

    /* Small, clean replay button */
    .replay-btn {
    padding: 6px 14px;
    border: 1px solid #e5e7eb;
    background: #ffffff;
    cursor: pointer;
    font-weight: 600;
    font-size: 13px;
    border-radius: 6px;
    color: #374151;
    transition: all 0.2s ease;
    }

    .replay-btn:hover {
    background: #f9fafb;
    border-color: #d1d5db;
    }

    .logo-container { 
    display: flex; 
    align-items: center; 
    gap: 12px; 
    }

    .emoji-logo { font-size: 24px; }
    .source-text {
    font-size: clamp(10px, 1.6vw, 16px);
    font-weight: 600;
    color: #333;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
    font-style: normal;
}

    .source-text a {
        color: #2756d3;
        text-decoration: underline;
        cursor: pointer;
        font-style: normal;
    }

   


    /* .source-text { 
    font-size: 14px; 
    font-weight: 700; 
    color: #111; 
    } */

    /* .control-bar { 
      grid-row: 2; 
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 24px;
      background: #fcfcfc; border-top: 1px solid #eee; z-index: 10;
      gap: 20px;
    }

    /* Segmented Control Style Container */

    /* Control Bar - Matching the provided code style */
    /* .control-bar { 
      grid-row: 2; 
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 24px;
      background: #fcfcfc; border-top: 1px solid #eee; z-index: 10;
    }

    .btn-group { display: flex; gap: 10px; }
    
    button {
      padding: 8px 16px;
      border: 1px solid #333;
      background: white;
      cursor: pointer;
      font-weight: 700;
      font-size: 13px;
      font-family: inherit;
      border-radius: 6px;
      transition: all 0.2s;
    }

    button:hover { background: #000; color: #fff; }

    .source-text { font-size: 15px; font-weight: 700; color: #111; }
    .source-text a { color: #2756d3; text-decoration: underline; text-underline-offset: 3px; }
    
    .logo-container { display: flex; align-items: center; gap: 10px; }
    .logo { height: 26px; width: auto; }
    .sep { color: #9ca3af; font-size: 18px; margin: 0 4px; } */

    #error-log {
        display: none; position: absolute; top: 0; left: 0; width: 100%; 
        background: rgba(255,255,255,0.95); color: red; z-index: 9999; padding: 20px;
    }
    /* Responsive font sizes for the large feature message */
    @media (max-width: 768px) {
    .feature-msg {
        font-size: 24px !important;
    }
    .source-text {
        font-size: 11px !important;
    }
    .control-bar {
        padding: 8px 16px;
    }
    }

    /* Ensure the SVG container takes up all available space in its box */
    #chart-container {
    width: 100%;
    height: 100%;
    min-height: 300px; /* Prevents the box from collapsing */
    }
  </style>
</head>
<body>

  <div id="error-log"></div>

  <div class="viz-grid">
    <div id="chart-container">
      <svg id="timeline-svg"></svg>
    </div>

    <div class="control-bar">
        <div class="source-text">
            Source: <a href="https://aiworld.eu" target="_blank">AI World</a>
        </div>

        <div class="right-controls">
            <button onclick="replayAnimation()" class="replay-btn">â†º Replay</button>
            <div class="logo-container">
            <span class="emoji-logo">ðŸ¤—</span> 
            <span class="sep">Ã—</span>
            <img src="logo.svg" class="logo" alt="AI World" onerror="this.style.display='none'; this.previousElementSibling.style.display='none';">
            </div>
        </div>
        </div>

    <!-- <div class="control-bar">
      <div class="source-text">Source: <a href="https://huggingface.co/spaces/open-llm-leaderboard/open_llm_leaderboard" target="_blank">Hugging Face Open Model Leaderboard</a></div>

      <div class="btn-group">
        <button onclick="replayAnimation()" id="btn-replay">â†º Replay</button>
        <button id="btn-toggle" onclick="toggleView()" class="active">Curved View</button>
      </div>
      
      <div class="logo-container">
        <span style="font-size: 24px;">ðŸ¤—</span> 
        <span class="sep">Ã—</span>
        <img src="logo.svg" class="logo" alt="AI World" onerror="this.style.display='none'; this.previousElementSibling.style.display='none';"> 
      </div>
    </div> -->
    <!-- <div class="control-bar">
      <div class="btn-group">
        <button onclick="replayAnimation()">â†º Replay</button>
        <button id="toggle-view" onclick="toggleView()">View Straight Timeline</button>
      </div>
      
      <div class="logo-container">d
        <div class="source-text">Source: <a href="https://huggingface.co/spaces/open-llm-leaderboard/open_llm_leaderboard" target="_blank">Hugging Face Open Model Leaderboard</a></div>
        <img src="https://huggingface.co/front/assets/huggingface_logo-noborder.svg" class="logo" alt="HF">
        <span class="sep">Ã—</span>
        <img src="logo.svg" class="logo" alt="AI World" onerror="this.style.display='none'"> 
        </div>
    </div> -->
  </div>

<script>
try {
    // Populated descriptions for every model to ensure the message changes
    
   const DATA = [
     { date: "2025-01-08", event: "Phi-4", org: "Microsoft", color: "#737373", description: "Demonstrated efficient small language models could punch above their weight class", dx: -5, dy: -10 },
    { date: "2025-01-20", event: "DeepSeek R1", org: "DeepSeek", color: "#003366", description: "Redefined what was possible for open models with breakthrough reasoning capabilities", dx: 0, dy: -10 },
    { date: "2025-03-12", event: "Gemma 3", org: "Google", color: "#4285F4", description: "Enabled strong performance for cheap and fast tasks, democratizing AI deployment", dx: -10, dy: -10 },
    { date: "2025-04-05", event: "Llama 4", org: "Meta", color: "#0866FF", description: "Advanced multimodal understanding and set new standards for open-weight foundation models", dx: 10, dy: 20 },
    { date: "2025-04-28", event: "Qwen3 family", org: "Alibaba", color: "#FF6A00", description: "Brought multilingual excellence and strong reasoning to the open source community", dx: -20, dy: -10 },
    { date: "2025-05-07", event: "Mistral Medium 3", org: "Mistral AI", color: "#E0002A", description: "Balanced efficiency and capability, proving European AI could compete globally", dx: 10, dy: 25 },
    { date: "2025-07-11", event: "Kimi K2", org: "Moonshot AI", color: "#6A1B9A", description: "Pioneered extended context windows for open models, enabling novel long-form applications", dx: 15, dy: 15 },
    { date: "2025-07-28", event: "GLM-4.5", org: "Zhipu", color: "#00A3A3", description: "Advanced Chinese language understanding", dx: -30, dy: -5 },
    { date: "2025-08-05", event: "OpenAI GPT-OSS", org: "OpenAI", color: "#000000", description: "Showed OpenAI's renewed commitment to open source", dx: 20, dy: 20 },
    // { date: "2025-08-21", event: "DeepSeek V3.1", org: "DeepSeek", color: "#003366", description: "Refined training efficiency and proved cost-effective scaling for open models", dx: -25, dy: -15 },
    { date: "2025-09-02", event: "Apertus LLM", org: "Switzerland", color: "#D52B1E", description: "Open model specifically designed for transparent research and reproducibility", dx: 25, dy: 15 },
    { date: "2025-10-27", event: "MiniMax M2", org: "MiniMax", color: "#FF2D55", description: "Excellent agentic and coding performance", dx: -25, dy: -15 },
    { date: "2025-11-20", event: "Olmo3", org: "AllenAI", color: "#D52B1E", description: "Fully transparent training process from data to weights, raising reproducibility standards", dx: 25, dy: 15 },
    { date: "2025-12-01", event: "DeepSeek V3.2", org: "DeepSeek", color: "#003366", description: "Further optimized inference costs while maintaining frontier model performance", dx: -30, dy: -10 },
    { date: "2025-12-11", event: "Molmo2", org: "AllenAI", color: "#D52B1E", description: "Advanced open multimodal understanding with fully documented training methodology", dx: 5, dy: 10 },
    { date: "2025-12-15", event: "Nemotron 3 Nano", org: "NVIDIA", color: "#76B900", description: "SOTA open agentic model", dx: -10, dy: 0 },
    { date: "2025-12-15", event: "Nemotron 3 Nano", org: "NVIDIA", color: "#76B900", description: "What a year!", dx: -10, dy: 0 },
    { date: "2025-12-15", event: "Nemotron 3 Nano", org: "NVIDIA", color: "#76B900", description: "2025 Timeline of major open source AI releases", dx: -10, dy: 0 },
    ];
    let state = { k: 0, timer: null, isStraight: false };
    const svg = d3.select("#timeline-svg");
    const container = document.getElementById("chart-container");

    // Math for positioning
    function getPoint(t, width, height, margin, isStraight) {
      const x = margin.left + t * (width - margin.left - margin.right);
      if (isStraight) {
        return { x, y: height / 2 + 50 }; // Lower down to leave room for top labels
      } else {
        const k = 2.5; // Curvature factor
        const normalizedY = (Math.exp(k * t) - 1) / (Math.exp(k) - 1);
        const y = (height - margin.bottom) - normalizedY * (height - margin.top - margin.bottom);
        return { x, y };
      }
    }
    function render() {
  const rect = container.getBoundingClientRect();
  const width = rect.width;
  const height = rect.height;

  // 1. Define Responsive Scaling Factors
  const isSmall = width < 700;
  const isTiny = width < 450;
  
  // As width decreases, we INCREASE the multiplier for offsets to avoid crowding
  const offsetMultiplier = isSmall ? (isTiny ? 11 : 9) : 7;

  const margin = { 
    left: isSmall ? 50 : 100, 
    right: isSmall ? 70 : 120, 
    top: isSmall ? 100 : 140, 
    bottom: isSmall ? 60 : 80 
  };

  // Fluid Typography for the centered message
  // const messageFontSize = Math.max(16, Math.min(width * 0.05, 34)) + "px";
  const messageFontSize = Math.max(16, Math.min(width * 0.05, 12)) + "px";
  const labelFontSize = isSmall ? (isTiny ? "10px" : "11px") : "13px";
  const orgFontSize = isSmall ? (isTiny ? "8px" : "9px") : "11px";

  svg.attr("width", width).attr("height", height).selectAll("*").remove();

  const parseTime = d3.utcParse("%Y-%m-%d");
  const data = DATA.map(d => ({ ...d, dateObj: parseTime(d.date) })).sort((a,b) => a.dateObj - b.dateObj);
  const visibleData = data.slice(0, state.k);
  const timeScale = d3.scaleTime().domain(d3.extent(data, d => d.dateObj)).range([0, 1]);

  // 2. Timeline Path
  if (visibleData.length > 0) {
    const pathData = [];
    const lastT = timeScale(visibleData[visibleData.length - 1].dateObj);
    for (let i = 0; i <= 80; i++) {
      pathData.push(getPoint((i/80) * lastT, width, height, margin, state.isStraight));
    }
    const lineGen = d3.line().x(d => d.x).y(d => d.y).curve(d3.curveBasis);
    svg.append("path").attr("d", lineGen(pathData)).attr("stroke", "#111").attr("stroke-width", 2.5).attr("fill", "none");
  }

  // 3. Month Markers
  const months = d3.utcMonth.range(data[0].dateObj, data[data.length-1].dateObj, 2);
  months.forEach(m => {
    const p = getPoint(timeScale(m), width, height, margin, state.isStraight);
    svg.append("text")
      .attr("x", p.x).attr("y", p.y + (isSmall ? 30 : 45))
      .attr("text-anchor", "middle").attr("font-weight", "800").attr("fill", "#000")
      .attr("font-size", isSmall ? "11px" : "14px").text(d3.utcFormat("%b")(m));
  });

  // 4. Events & Labels
  visibleData.forEach((d, i) => {
    const p = getPoint(timeScale(d.dateObj), width, height, margin, state.isStraight);
    const isAlternate = i % 2 === 0;
    
    // Increased offsets for smaller boxes
    // If no manual dx/dy exists, we use a larger default for smaller boxes
    const defaultDx = (isAlternate ? -1 : 1) * (isSmall ? 60 : 70);
    const defaultDy = 0;

    // Apply the offsetMultiplier to the manual dx/dy properties
    const labelX = p.x + (d.dx !== undefined ? d.dx * offsetMultiplier : defaultDx);
    const labelY = p.y + (d.dy !== undefined ? d.dy * offsetMultiplier : defaultDy);
    
    const anchor = labelX < p.x ? "end" : "start";

    // Connector Line
    svg.append("line")
      .attr("x1", p.x).attr("y1", p.y)
      .attr("x2", labelX - (anchor === "end" ? -5 : 5)).attr("y2", labelY)
      .attr("stroke", "#e5e7eb").attr("stroke-width", 1.2).attr("stroke-dasharray", "3,2");

    // Labels
    const labelGroup = svg.append("g");
    labelGroup.append("text")
      .attr("x", labelX).attr("y", labelY)
      .attr("text-anchor", anchor).attr("fill", d.color).attr("font-weight", "700")
      .attr("font-size", labelFontSize).text(d.event);

    if (d.org) {
      labelGroup.append("text")
        .attr("x", labelX).attr("y", labelY - (isSmall ? 12 : 16))
        .attr("text-anchor", anchor).attr("fill", "#6b7280").attr("font-weight", "500")
        .attr("font-size", orgFontSize).text(d.org);
    }

    // Dot
    svg.append("circle")
      .attr("cx", p.x).attr("cy", p.y).attr("r", isSmall ? 4 : 5.5)
      .attr("fill", d.color).attr("stroke", "#fff").attr("stroke-width", 2.5);

    // 5. Centered Resizing Message
    if (i === visibleData.length - 1 && d.description) {
      svg.append("text")
        .attr("x", width / 2)
        .attr("y", margin.top / 2.2)
        .attr("text-anchor", "middle")
        .attr("font-size", messageFontSize) 
        .attr("font-weight", "700")
        .attr("fill", "#111")
        .text(d.description);
    }
  });
}
   

    function replayAnimation() {
      if(state.timer) clearInterval(state.timer);
      state.k = 0;
      render();
      state.timer = setInterval(() => {
        if (state.k < DATA.length) { 
            state.k++; 
            render(); 
        } else { 
            clearInterval(state.timer); 
            state.timer = null;
        }
      }, 1200); // 500ms per step
    }
    function toggleView() {
      state.isStraight = !state.isStraight;
      const btn = document.getElementById("btn-toggle");
      
      // Update Button Text & State
      if (state.isStraight) {
          btn.innerText = "Straight View";
          btn.classList.add("active"); // Keep it active or toggle style as preferred
      } else {
          btn.innerText = "Curved View";
          btn.classList.remove("active"); 
          // You might want to swap active class between two separate buttons if you had two
      }
      render();
    }

    // function toggleView() {
    //   state.isStraight = !state.isStraight;
    //   document.getElementById("toggle-view").innerText = state.isStraight ? "View Curved Timeline" : "View Straight Timeline";
    //   render();
    // }

    window.addEventListener('resize', render);
    
    // Start automatically
    replayAnimation();

    // Add this at the very bottom of your script
    window.addEventListener('resize', () => {
    render(); // Re-draws the timeline with new width/height calculations
    });

} catch (e) {
    console.error(e);
    document.getElementById('error-log').style.display = 'block';
    document.getElementById('error-log').innerHTML = "Error: " + e.message;
}
</script>
</body>
</html>
