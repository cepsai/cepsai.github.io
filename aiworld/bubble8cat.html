<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root { --fg:#111; --bg:#fff; --muted:#6b7280; --axis:#000; --accent:#0ea5a4; }
  html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font:16px/1.5 ui-sans-serif,system-ui,Segoe UI,Roboto,Arial}

  /* Contenedor a pantalla completa en columna */
  .wrap{
    min-height:100svh;         /* ocupa el alto de la ventana (mejor en móvil) */
    display:flex;
    flex-direction:column;
    gap:8px;
    padding:4px;
    max-width:none;            /* sin límite de ancho */
    margin:0;
  }

  h1{font-size:1.25rem;margin:0}
  .sub{color:var(--muted);margin:0 0 8px}

  /* El SVG crece para llenar el espacio restante */
  #chart{
    width:100vw;
    height:100vh;              /* clave: llena el alto disponible del flex */           /* ocupa todo el espacio libre */
    display:block;
  }
    
  .cluster-title{
    font-weight:700;
    font-size: 12px;
    fill:#000;
  }
  .axis text{fill:#000;font-size:.85rem; font-weight: 600;}
  .axis path,.axis line{stroke:var(--axis)}
  .grid line{stroke:var(--axis)}
  .label{fill:#000;font-size:.85rem; font-weight: 600}
  .dot{cursor:pointer;transition:filter .15s ease}
  .dot:hover{filter:drop-shadow(0 2px 6px rgba(0,0,0,.2))}
  .tooltip{
    position:fixed; pointer-events:none; opacity:0; transition:opacity .12s ease;
    background:#111;color:#fff;border-radius:10px;padding:8px 10px;font-size:.85rem
  }

  /* La leyenda queda abajo; el SVG crece por encima */
  .legend{display:flex;gap:10px;align-items:center;margin-top:8px;color:#374151}
  .badge{width:10px;height:10px;border-radius:999px;background:var(--accent)}
</style>
</head>
<body>
<div class="wrap">
  <!-- El viewBox permite que todo escale perfecto sin JS extra -->
  <svg id="chart" viewBox="0 0 900 520" role="img" aria-label="Bubble chart con logos"></svg>


</div>
<div class="tooltip" id="tip" aria-hidden="true"></div>

<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<script>
/* ======= 1) Tus datos ======= */
const data = [
  {
    "id": "OpenAI (US)",
    "country": "United States",
    "value": 6600000000,
    "category": "Education",
    "x_val": 1,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/jjykwqqhsscreywea4gb"
  },
  {
    "id": "Cerebras Systems (US)",
    "country": "United States",
    "value": 1100000000,
    "category": "Industry & Mobility",
    "x_val": 2,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/903279f00f1745288376698bbfae0c91"
  },
  {
    "id": "Nscale (GB)",
    "country": "United Kingdom",
    "value": 433000000,
    "category": "Software & cloud",
    "x_val": 3,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/248ba9b2996c41fd93b8b5c600f02374"
  },
  {
    "id": "Periodic Labs (US)",
    "country": "United States",
    "value": 300000000,
    "category": "Education",
    "x_val": 4,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/528018a6368d42f790c9e6c23cf92e61"
  },
  {
    "id": "Vercel (US)",
    "country": "United States",
    "value": 300000000,
    "category": "Industry & Mobility",
    "x_val": 5,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/dtokjerhk1dxyludtlwc"
  },
  {
    "id": "Rebellions (KR)",
    "country": "South Korea",
    "value": 250000000,
    "category": "Industry & Mobility",
    "x_val": 6,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/fm0kkmmcqbc6qaj6iaej"
  },
  {
    "id": "Eve (US)",
    "country": "United States",
    "value": 103000000,
    "category": "Legal & Compliance",
    "x_val": 7,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/76f7a1d360914d789ff64ea7acc91dea"
  },
  {
    "id": "Supabase (US)",
    "country": "United States",
    "value": 100000000,
    "category": "Data",
    "x_val": 8,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/shcbxwzc3rgg8del8jbp"
  },
  {
    "id": "Pendo (US)",
    "country": "United States",
    "value": 100000000,
    "category": "Data",
    "x_val": 9,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/axx7yoim60p3x25lk4ys"
  },
  {
    "id": "DualEntry (US)",
    "country": "United States",
    "value": 90000000,
    "category": "Software & cloud",
    "x_val": 10,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/9a5f5823a5884687ad495a91f5ed3c46"
  },
  {
    "id": "Feedzai (PT)",
    "country": "Portugal",
    "value": 75000000,
    "category": "Finance",
    "x_val": 11,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/v1432491751/oermfrknucrvhmptebaw.png"
  },
  {
    "id": "Heidi Health (AU)",
    "country": "Australia",
    "value": 65000000,
    "category": "Health",
    "x_val": 12,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/ixxzxrubulvk2mlyv9vl"
  },
  {
    "id": "Axiom Math AI (US)",
    "country": "United States",
    "value": 64000000,
    "category": "Education",
    "x_val": 13,
    "logo": 0
  },
  {
    "id": "Harvey (US)",
    "country": "United States",
    "value": 59000000,
    "category": "Legal & Compliance",
    "x_val": 14,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/130c3d3fb2274495adc94f5efde4f7bd"
  },
  {
    "id": "Phaidra (US)",
    "country": "United States",
    "value": 50000000,
    "category": "Education",
    "x_val": 15,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/ctl1oezne6koh6idewyx"
  },
  {
    "id": "Simple (CY)",
    "country": "Cyprus",
    "value": 35000000,
    "category": "Health",
    "x_val": 16,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/rkqouzbnm97cizuaxi5n"
  },
  {
    "id": "M.AI Unbound, Inc (US)",
    "country": "United States",
    "value": 25000000,
    "category": "Software & cloud",
    "x_val": 17,
    "logo": 0
  },
  {
    "id": "Summation (US)",
    "country": "United States",
    "value": 21000000,
    "category": "Data",
    "x_val": 18,
    "logo": 0
  },
  {
    "id": "Lexroom.ai (IT)",
    "country": "Italy",
    "value": 19000000,
    "category": "Legal & Compliance",
    "x_val": 19,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/2e077bcea5784612ae82dcde36880287"
  },
  {
    "id": "Blossom Health (US)",
    "country": "United States",
    "value": 18400000,
    "category": "Health",
    "x_val": 20,
    "logo": 0
  },
  {
    "id": "Zania (US)",
    "country": "United States",
    "value": 18000000,
    "category": "Legal & Compliance",
    "x_val": 21,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/a9bb5e240ea944deb7fd080a1466af6c"
  },
  {
    "id": "Deciphex (IE)",
    "country": "Ireland",
    "value": 17595535,
    "category": "Health",
    "x_val": 22,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/4d761e445fce4012b73657d2a6f82fe8"
  },
  {
    "id": "Alex AI (US)",
    "country": "United States",
    "value": 17000000,
    "category": "Software & cloud",
    "x_val": 23,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/vpfelhsxa7uxpwzeyvuh"
  },
  {
    "id": "Acelab (US)",
    "country": "United States",
    "value": 16567158,
    "category": "Industry & Mobility",
    "x_val": 24,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/cda2e654e5024457ac2b9d04bd4c11ed"
  },
  {
    "id": "Lastro (BR)",
    "country": "Brazil",
    "value": 15995484,
    "category": "Finance",
    "x_val": 25,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/dutryvpxkvjqjcw2syym"
  },
  {
    "id": "StratifAI (DE)",
    "country": "Germany",
    "value": 14679339,
    "category": "Health",
    "x_val": 26,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/a834975423de4fd1a9d78154354ef566"
  },
  {
    "id": "Audioshake (US)",
    "country": "United States",
    "value": 14000000,
    "category": "Education",
    "x_val": 27,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/cr3lvam3oq01w02s9hal"
  },
  {
    "id": "CYVL (US)",
    "country": "United States",
    "value": 14000000,
    "category": "Industry & Mobility",
    "x_val": 28,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/3e4a1f0e6de74746a80ab48e3e312942"
  },
  {
    "id": "Summation (US)",
    "country": "United States",
    "value": 12374999,
    "category": "Data",
    "x_val": 29,
    "logo": 0
  },
  {
    "id": "Price.com (US)",
    "country": "United States",
    "value": 12000000,
    "category": "Data",
    "x_val": 30,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/sce7s6stovhzhgjalqbn"
  },
  {
    "id": "Anything (US)",
    "country": "United States",
    "value": 11000000,
    "category": "Software & cloud",
    "x_val": 31,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/z1smno0xacpix13e4dgv"
  },
  {
    "id": "Confido Health (US)",
    "country": "United States",
    "value": 10000000,
    "category": "Health",
    "x_val": 32,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/006e581f5d604e34bb29a0f7a596b48b"
  },
  {
    "id": "Talus Network (US)",
    "country": "United States",
    "value": 10000000,
    "category": "Software & cloud",
    "x_val": 33,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/qcagn6taxqpe9pcvyfq2"
  },
  {
    "id": "GreyLabs AI (IN)",
    "country": "India",
    "value": 9574809,
    "category": "Data",
    "x_val": 34,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/wkkfwzzs122wenj7juey"
  },
  {
    "id": "TiHive Technologies (FR)",
    "country": "France",
    "value": 9384285,
    "category": "Industry & Mobility",
    "x_val": 35,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/brxz6b8yglees0ogwewb"
  },
  {
    "id": "Arzeda (US)",
    "country": "United States",
    "value": 7800000,
    "category": "Health",
    "x_val": 36,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/ahyqf4pgjiq9yrfskoq3"
  },
  {
    "id": "Orbotix (RO)",
    "country": "Romania",
    "value": 7642294,
    "category": "Legal & Compliance",
    "x_val": 37,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/shefwhmggkpim9buysmv"
  },
  {
    "id": "Tern AI (US)",
    "country": "United States",
    "value": 7500000,
    "category": "Software & cloud",
    "x_val": 38,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/2ce1c036859444e29171f80f78832ff0"
  },
  {
    "id": "I-Genie (US)",
    "country": "United States",
    "value": 7500000,
    "category": "Software & cloud",
    "x_val": 39,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/20a767c974e54228bf3a2779a918812c"
  },
  {
    "id": "Korea Deep Learning (KR)",
    "country": "South Korea",
    "value": 7126533,
    "category": "Software & cloud",
    "x_val": 40,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/fji4pakrzcmwgren2rge"
  },
  {
    "id": "Tier IV (JP)",
    "country": "Japan",
    "value": 7000000,
    "category": "Industry & Mobility",
    "x_val": 41,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/ojhgqe25qgwzv3mlv5g4"
  },
  {
    "id": "Bettani (US)",
    "country": "United States",
    "value": 6500000,
    "category": "Health",
    "x_val": 42,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/egy3dgyy2yfkmhcg3zk4"
  },
  {
    "id": "Archive Intel (US)",
    "country": "United States",
    "value": 6300000,
    "category": "Finance",
    "x_val": 43,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/cd65da0d8575462cad8ce380e96582a3"
  },
  {
    "id": "Hipp Health (US)",
    "country": "United States",
    "value": 6200000,
    "category": "Health",
    "x_val": 44,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/5321429746a04a0eb5492997d76a75b5"
  },
  {
    "id": "Dashmote (NL)",
    "country": "The Netherlands",
    "value": 6000000,
    "category": "Education",
    "x_val": 45,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/v1505821319/juhtkikw0j3fglkilgi4.png"
  },
  {
    "id": "Trig (GB)",
    "country": "United Kingdom",
    "value": 6000000,
    "category": "Software & cloud",
    "x_val": 46,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/c875715fbe3140eab96ffeb3a32b183b"
  },
  {
    "id": "Fleak (US)",
    "country": "United States",
    "value": 5000000,
    "category": "Cybersecurity",
    "x_val": 47,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/236813bf989d46c6ac5cc81776468637"
  },
  {
    "id": "MythWorx (US)",
    "country": "United States",
    "value": 5000000,
    "category": "Health",
    "x_val": 48,
    "logo": 0
  },
  {
    "id": "Lunos (US)",
    "country": "United States",
    "value": 5000000,
    "category": "Software & cloud",
    "x_val": 49,
    "logo": 0
  },
  {
    "id": "Assessli (IN)",
    "country": "India",
    "value": 4996959,
    "category": "Education",
    "x_val": 50,
    "logo": 0
  },
  {
    "id": "DataJoint (US)",
    "country": "United States",
    "value": 4900000,
    "category": "Education",
    "x_val": 51,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/vewdppwu85lt8lgy9cgp"
  },
  {
    "id": "Flai (US)",
    "country": "United States",
    "value": 4500000,
    "category": "Industry & Mobility",
    "x_val": 52,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/1bea93b5833647e8a1383484ea2b8f4a"
  },
  {
    "id": "Aragorn AI (US)",
    "country": "United States",
    "value": 4300000,
    "category": "Data",
    "x_val": 53,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/dlde7tmoeioz06bj5kle"
  },
  {
    "id": "Bookline (ES)",
    "country": "Spain",
    "value": 4110215,
    "category": "Health",
    "x_val": 54,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/id9sojgpai24idkhj9yg"
  },
  {
    "id": "Ignosis (IN)",
    "country": "India",
    "value": 4000000,
    "category": "Finance",
    "x_val": 55,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/eogxvpxwxifgbmor6idb"
  },
  {
    "id": "viboo (CH)",
    "country": "Switzerland",
    "value": 3879934,
    "category": "Education",
    "x_val": 56,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/bn76wy5pwlugelory2tc"
  },
  {
    "id": "Arqh (CH)",
    "country": "Switzerland",
    "value": 3800000,
    "category": "Industry & Mobility",
    "x_val": 57,
    "logo": 0
  },
  {
    "id": "Mind The Hack (GR)",
    "country": "Greece",
    "value": 3282909,
    "category": "Cybersecurity",
    "x_val": 58,
    "logo": 0
  },
  {
    "id": "Actual AI (US)",
    "country": "United States",
    "value": 3200000,
    "category": "Software & cloud",
    "x_val": 59,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/71747a2b23d8475a85e1c87bdfdcbbe9"
  },
  {
    "id": "Metreecs (US)",
    "country": "United States",
    "value": 3165663,
    "category": "Education",
    "x_val": 60,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/e7df21a07b3942dab9b6a266d76d5d5a"
  },
  {
    "id": "Supermemory (GB)",
    "country": "United Kingdom",
    "value": 3000000,
    "category": "Data",
    "x_val": 61,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/41be1c7ab645409995ee8f48b41987dc"
  },
  {
    "id": "AdaptX (US)",
    "country": "United States",
    "value": 2663999,
    "category": "Health",
    "x_val": 62,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/iy5qjaf5jmmrq5g6gzw6"
  },
  {
    "id": "Lilac (US)",
    "country": "United States",
    "value": 2500000,
    "category": "Education",
    "x_val": 63,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/200a253e5ce546a4beb2dee0cae0f690"
  },
  {
    "id": "Stelrix (US)",
    "country": "United States",
    "value": 2500000,
    "category": "Finance",
    "x_val": 64,
    "logo": 0
  },
  {
    "id": "Navi AI (US)",
    "country": "United States",
    "value": 2350000,
    "category": "Software & cloud",
    "x_val": 65,
    "logo": 0
  },
  {
    "id": "Libertify (FR)",
    "country": "France",
    "value": 2346922,
    "category": "Software & cloud",
    "x_val": 66,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/ah8uovh8upqhczv2qptw"
  },
  {
    "id": "MiChamba (US)",
    "country": "United States",
    "value": 2250000,
    "category": "Software & cloud",
    "x_val": 67,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/72651fcafba9487cb6a8de6ad885c264"
  },
  {
    "id": "HELIOS (US)",
    "country": "United States",
    "value": 2200000,
    "category": "Data",
    "x_val": 68,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/piwxqytycxjfsmefppiy"
  },
  {
    "id": "Ainekko (US)",
    "country": "United States",
    "value": 2150000,
    "category": "Software & cloud",
    "x_val": 69,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/smmhkcdub2p3vkt2azgn"
  },
  {
    "id": "Personal Health Tech (JP)",
    "country": "Japan",
    "value": 2038622,
    "category": "Health",
    "x_val": 70,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/d30ae7843eb249cd886d6871c76f311c"
  },
  {
    "id": "Climaty AI (AE)",
    "country": "United Arab Emirates",
    "value": 2000000,
    "category": "Software & cloud",
    "x_val": 71,
    "logo": 0
  },
  {
    "id": "Infrrd (US)",
    "country": "United States",
    "value": 1999994,
    "category": "Finance",
    "x_val": 72,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/v1486586593/dcylrx0kuwixdj6gtbfs.jpg"
  },
  {
    "id": "Clear (NL)",
    "country": "The Netherlands",
    "value": 1993429,
    "category": "Health",
    "x_val": 73,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/g21e5qkkkgudqd7n3dqb"
  },
  {
    "id": "Sera (EE)",
    "country": "Estonia",
    "value": 1759940,
    "category": "Software & cloud",
    "x_val": 74,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/ffd63699802144d1aa2075fa9e42202d"
  },
  {
    "id": "Hupside (US)",
    "country": "United States",
    "value": 1700000,
    "category": "Software & cloud",
    "x_val": 75,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/cb038f1f4f4845ceb3c83eee2c96028d"
  },
  {
    "id": "Enhance Labs (AU)",
    "country": "Australia",
    "value": 1520752,
    "category": "Software & cloud",
    "x_val": 76,
    "logo": 0
  },
  {
    "id": "Zwayam (IN)",
    "country": "India",
    "value": 1351496,
    "category": "Software & cloud",
    "x_val": 77,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/c2qwjre6fukkxpzlqxbf"
  },
  {
    "id": "Rehuman (GB)",
    "country": "United Kingdom",
    "value": 1347841,
    "category": "Finance",
    "x_val": 78,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/eb9238c48a3a4b6d80fd1f4b394fc176"
  },
  {
    "id": "AndromedAI (IT)",
    "country": "Italy",
    "value": 1289866,
    "category": "Software & cloud",
    "x_val": 79,
    "logo": 0
  },
  {
    "id": "EYSZ (US)",
    "country": "United States",
    "value": 545156,
    "category": "Health",
    "x_val": 80,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/excowthbw2ajdgvrkt8b"
  },
  {
    "id": "FoxEyes (US)",
    "country": "United States",
    "value": 540000,
    "category": "Health",
    "x_val": 81,
    "logo": 0
  },
  {
    "id": "Immersely (GB)",
    "country": "United Kingdom",
    "value": 537795,
    "category": "Software & cloud",
    "x_val": 82,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/2b2c630e840a474f8b124ca115576da5"
  },
  {
    "id": "Mohi (US)",
    "country": "United States",
    "value": 500000,
    "category": "Software & cloud",
    "x_val": 83,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/ed7249a49d974546b814586a7ea23730"
  },
  {
    "id": "Akson Robotics (DK)",
    "country": "Denmark",
    "value": 470724,
    "category": "Industry & Mobility",
    "x_val": 84,
    "logo": 0
  },
  {
    "id": "Akson Robotics (DK)",
    "country": "Denmark",
    "value": 470724,
    "category": "Industry & Mobility",
    "x_val": 85,
    "logo": 0
  },
  {
    "id": "Affluense AI (IN)",
    "country": "India",
    "value": 337934,
    "category": "Software & cloud",
    "x_val": 86,
    "logo": 0
  },
  {
    "id": "DriveX (JP)",
    "country": "Japan",
    "value": 332886,
    "category": "Software & cloud",
    "x_val": 87,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/7124be000f4c48af8f3c42361b71976d"
  },
  {
    "id": "Patrol 6 (US)",
    "country": "United States",
    "value": 213341,
    "category": "Industry & Mobility",
    "x_val": 88,
    "logo": 0
  },
  {
    "id": "Donkit (IL)",
    "country": "Israel",
    "value": 200000,
    "category": "Software & cloud",
    "x_val": 89,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/66f3d56abfdd46dd92ae4d2ffbee8975"
  },
  {
    "id": "LUXE AI (US)",
    "country": "United States",
    "value": 100000,
    "category": "Cybersecurity",
    "x_val": 90,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/813d4ccaa7ac4f09810310abf634fea6"
  },
  {
    "id": "Monostate (US)",
    "country": "United States",
    "value": 95000,
    "category": "Education",
    "x_val": 91,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/69048ebd69334235ac6f2e0b90239cfe"
  },
  {
    "id": "Kimaru AI (US)",
    "country": "United States",
    "value": 75000,
    "category": "Industry & Mobility",
    "x_val": 92,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/2b433b53a54b45b58a83e5cb4704d3c8"
  },
  {
    "id": "Apptronik (US)",
    "country": "United States",
    "value": 64500,
    "category": "Industry & Mobility",
    "x_val": 93,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/41092fa73a77fb8e2c11"
  },
  {
    "id": "Belto (US)",
    "country": "United States",
    "value": 30000,
    "category": "Industry & Mobility",
    "x_val": 94,
    "logo": "https://images.crunchbase.com/image/upload/t_cb-default-original/0e470bc4bee6448ab042e879bd7c38a6"
  }
];
/* Mapea country (o id) -> URL del logo (puede ser flag, marca, etc.) */


/* ======= 2) Medidas y contenedor ======= */
const svg = d3.select("#chart");
const W = 900, H = 520;
const m = { top: 16, right: 16, bottom: 16, left: 16 };
const innerW = W - m.left - m.right;
const innerH = H - m.top - m.bottom;

const g = svg.append("g").attr("transform", `translate(${m.left},${m.top})`);

/* ======= 3) Escalas ======= */
const cats = Array.from(new Set(data.map(d => d.category)));
const x = d3.scaleBand().domain(cats).range([0, innerW]).padding(0.25);

const maxVal = d3.max(data, d => d.value) || 1;
const y = d3.scaleSymlog()
  .constant(maxVal / 50)   // “curvatura”; sube/baja para más/menos compresión
  .domain([0, maxVal])
  .range([innerH, 0])
  .nice();

// Tamaño de logo en función de value (raíz para percepción)
const r = d3.scaleSqrt().domain([0, maxVal]).range([12, 60]);
/* ======= 4) Ejes y grillas ======= */


const xAxis = g.append("g")
  .attr("class", "axis axis--x")
  .attr("transform", `translate(0,${innerH})`)
  .call(d3.axisBottom(x).tickPadding(12)); 
  

    function wrapTicks(selection, width) {
  const lineHeight = 1.1; // en em
  selection.each(function () {
    const text = d3.select(this);
    const words = text.text().split(/\s+/).filter(Boolean);
    text.text(null); // limpiamos el <text>

    let line = [];
    let lineNumber = 0;
    let tspan = text.append("tspan").attr("x", 0).attr("dy", "0em");

    for (const w of words) {
      line.push(w);
      tspan.text(line.join(" "));
      if (tspan.node().getComputedTextLength() > width) {
        line.pop();
        tspan.text(line.join(" "));
        line = [w];
        tspan = text.append("tspan")
          .attr("x", 0)
          .attr("dy", `${++lineNumber * lineHeight}em`)
          .text(w);
      }
    }
    text.attr("text-anchor","middle");
  });
}

// aplica el wrap usando el ancho de la categoría
xAxis.selectAll("text").call(wrapTicks, x.bandwidth())
xAxis.selectAll("text").remove();
const fmtShort = d => d3.format(".2s")(d).replace("G","B");

const customTicks = [0.1e9, 0.5e9, 1e9, 2e9, 3.5e9, 6e9, 8e9].filter(v => v >= y.domain()[0] && v <= y.domain()[1]);

g.append("g")
  .attr("class","axis")
  .call(d3.axisLeft(y).tickValues(customTicks).tickFormat(() => ""));
g.append("text").attr("class","label")
  .attr("x", innerW/2).attr("y", innerH + 50).attr("text-anchor","middle").text("");

g.append("text").attr("class","label")
  .attr("x", -innerH/2).attr("y", -50).attr("transform","rotate(-90)").attr("text-anchor","middle").text("");

/* ======= 5) Puntos (logos) — empaquetado por categoría ======= */
const GAP = 8;                    // separación mínima entre logos (px)
const SHAPE_FACTOR = Math.SQRT2;
// centro de cada categoría y altura fija (Y sin significado)

// ✅ Nuevo layout en rejilla: posiciones tipo columna.fila (col.row)
const NUM_ROWS = 2;                                  // filas: 1..4
const nCols   = Math.ceil(cats.length / NUM_ROWS);   // cuántas columnas necesitamos
const colW    = innerW / nCols;                      // ancho de cada columna
const rowH    = innerH / NUM_ROWS;                   // alto de cada fila

// Mapa categoría -> {col, row} siguiendo el orden en 'cats'
const catPos = new Map(
  cats.map((c, i) => [c, { col: Math.floor(i / NUM_ROWS), row: i % NUM_ROWS }])
);

// Centros del racimo por categoría (columna.fila → píxeles)
const xCenter = d => {
  const { col } = catPos.get(d.category);
  return col * colW + colW / 2;
};
const yCenter = cat => {
  const { row } = catPos.get(cat);
  return row * rowH + rowH / 2;
};

// 1) agrupa datos por categoría
const groups = d3.group(data, d => d.category);
const clusterH = Math.min(rowH * 0.8, 240); // se adapta a la fila
  g.selectAll(".cluster-title")
  .data(cats)                               // ← un texto por categoría
  .join("text")
  .attr("class", "cluster-title")
  .attr("x", d => x(d) + x.bandwidth()/2)   // centro de la banda
  .attr("y", d => yCenter(d) - clusterH/2 + 30) // arriba del racimo
  .attr("text-anchor", "middle")
  .text(d => d); 
// 2) para cada grupo, calcula un layout compacto sin solapes
for (const [cat, arr] of groups) {
  // construye círculos con el radio visual (r(d.value))
  const circles = arr.map(d => ({ d, r: r(d.value) * Math.SQRT2 + GAP }));

  // coloca los círculos locales (x,y) sin superposición
  d3.packSiblings(circles); // muta: c.x, c.y y respeta c.r

  // 3) escala el racimo para que quepa dentro del ancho de la banda
  const pad = 6;
  const maxX = d3.max(circles, c => Math.abs(c.x) + c.r) || 1;
  const maxY = d3.max(circles, c => Math.abs(c.y) + c.r) || 1;

  // altura máxima opcional del racimo (ajusta a gusto)
  
  const sx = (x.bandwidth()/2 - pad) / maxX;
  const sy = (clusterH/2 - pad) / maxY;
  const s = 0.60;  // evita agrandar; solo reduce si hace falta

  // guarda posiciones locales empaquetadas por dato
  circles.forEach(c => {
    c.d._px = c.x * s;
    c.d._py = c.y * s;
  });

}


// 4) dibuja las imágenes en su categoría con el offset del racimo
const nodes = g.selectAll(".dot")
  .data(data)
  .join("image")
  .attr("class","dot")
  .attr("href", d => d.logo || "")
  .attr("width", d => r(d.value)*2)
  .attr("height", d => r(d.value)*2)
  .attr("preserveAspectRatio","xMidYMid meet")
  .attr("x", d => xCenter(d) + (d._px ?? 0) - r(d.value))
  .attr("y", d => yCenter(d.category) + (d._py ?? 0) - r(d.value))
  .on("mousemove", (event, d) => {
      tip.style.opacity = 1;
      tip.style.left = (event.clientX + 12) + "px";
      tip.style.top  = (event.clientY + 12) + "px";
      tip.innerHTML = `<strong>${d.country}</strong><br>${d.category}<br>Value: ${new Intl.NumberFormat().format(d.value)}<br>ID: ${d.id}`;
  })
  .on("mouseleave", () => { tip.style.opacity = 0; });

/* ======= 6) Responsivo ======= */
/* Ya no necesitamos JS para altura: el viewBox + CSS height:100% se encargan */
</script>
</body>
</html>
