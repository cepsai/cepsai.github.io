<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Timeline 2025</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">

  <style>
    /* iFrame & Mobile Optimization */
    html, body { 
      height: 100%; 
      margin: 0; 
      padding: 0; 
      overflow: hidden; 
      background: #ffffff; 
      font-family: 'Lato', sans-serif;
      -webkit-font-smoothing: antialiased;
    }
    
    /* Main Layout Grid */
    .viz-grid { 
      display: grid; 
      grid-template-rows: 1fr auto; /* Chart takes all space, controls sit below */
      height: 100vh; 
      width: 100vw; 
      box-sizing: border-box; 
      background: #ffffff;
    }
    
    /* Chart Container */
    #chart-container { 
      grid-row: 1; 
      position: relative; 
      width: 100%; 
      height: 100%; 
      overflow: hidden; 
      display: flex;
      align-items: center;
      justify-content: center;
    }

    svg { width: 100%; height: 100%; display: block; }
    
    /* Control Bar (The "Container" for buttons and logos) */
    .control-bar { 
      grid-row: 2; 
      display: grid;
      grid-template-columns: 1fr auto 1fr; /* Source | Buttons | Logos */
      align-items: center;
      padding: 12px 24px;
      border-top: 1px solid #e5e7eb;
      background: #ffffff;
      min-height: 50px;
    }

    /* Buttons Style (Screenshot 2) */
    .btn-group { display: flex; gap: 8px; justify-content: center; }
    .btn-pill { 
      padding: 6px 14px; 
      border: 1px solid #cfd2d7; 
      border-radius: 8px; 
      background: #ffffff; 
      font-weight: 700; 
      color: #26344f; 
      cursor: pointer;
      font-size: 13px;
      white-space: nowrap;
      transition: all 0.2s ease;
    }
    .btn-pill:hover { border-color: #2563eb; background: #f9fafb; }
    .btn-active { background: #2563eb !important; color: #ffffff !important; border-color: #2563eb; }

    /* Source & Logos */
    .source-text { font-size: 13px; font-weight: 600; color: #333; }
    .source-text a { color: #2756d3; text-decoration: underline; }
    
    .logo-container { display: flex; align-items: center; gap: 10px; justify-content: flex-end; height: 24px; }
    .logo { height: 100%; width: auto; max-width: 100px; object-fit: contain; }
    .sep { color: #d1d5db; font-size: 14px; }

    #tooltip { 
      position: absolute; background: #fff; border: 1px solid #d9d9df; 
      padding: 8px; font-size: 12px; opacity: 0; pointer-events: none; 
      box-shadow: 0 4px 12px rgba(0,0,0,0.1); border-radius: 6px; z-index: 100;
    }

    /* Responsive: Stack controls on very small screens */
    @media (max-width: 768px) {
      .control-bar { 
        grid-template-columns: 1fr 1fr; 
        grid-template-rows: auto auto; 
        gap: 12px;
      }
      .btn-group { grid-column: 1 / span 2; grid-row: 1; }
      .source-text { grid-column: 1; grid-row: 2; }
      .logo-container { grid-column: 2; grid-row: 2; }
    }
  </style>
</head>
<body>
  <div class="viz-grid">
    <div id="chart-container">
      <svg id="timeline-svg"></svg>
      <div id="tooltip"></div>
    </div>

    <div class="control-bar">
      <div class="source-text">Source: <a href="https://huggingface.co/" target="_blank">HuggingFace</a></div>

      <div class="btn-group">
        <button id="btnPlay" class="btn-pill btn-active">Play</button>
        <button id="btnReset" class="btn-pill">Reset</button>
        <button id="btnDownload" class="btn-pill">Download PNG</button>
      </div>

      <div class="logo-container">
        <img src="https://huggingface.co/front/assets/huggingface_logo-noborder.svg" class="logo" alt="HF">
        <span class="sep">×</span>
        <img src="logo.svg" class="logo" alt="AI World">
      </div>
    </div>
  </div>

<script>
const DATA = [
  { date: "2025-01-08", event: "Phi-4", org: "Microsoft", color: "#737373" },
  { date: "2025-01-20", event: "DeepSeek R1", org: "DeepSeek", color: "#003366" },
  { date: "2025-03-12", event: "Gemma 3", org: "Google", color: "#4285F4" },
  { date: "2025-03-17", event: "Mistral Small 3.1", org: "Mistral AI", color: "#E0002A" },
  { date: "2025-03-25", event: "Qwen Omni 7B", org: "Alibaba", color: "#FF6A00" },
  { date: "2025-04-05", event: "Llama 4", org: "Meta", color: "#0866FF" },
  { date: "2025-04-28", event: "Qwen3 family", org: "Alibaba", color: "#FF6A00" },
  { date: "2025-05-07", event: "Mistral Medium 3", org: "Mistral AI", color: "#E0002A" },
  { date: "2025-05-13", event: "AM Thinking v1", org: "A-M-Team", color: "#8C8CFF" },
  { date: "2025-07-11", event: "Kimi K2", org: "Moonshot AI", color: "#6A1B9A" },
  { date: "2025-07-28", event: "GLM-4.5", org: "Zhipu", color: "#00A3A3" },
  { date: "2025-08-05", event: "OpenAI GPT-OSS", org: "OpenAI", color: "#000000" },
  { date: "2025-08-21", event: "DeepSeek V3.1", org: "DeepSeek", color: "#003366" },
  { date: "2025-09-02", event: "Apertus LLM", org: "Switzerland (ETH Zürich, EPFL, CSCS)", color: "#D52B1E" },
  { date: "2025-09-05", event: "Qwen3 Max", org: "Alibaba", color: "#FF6A00" },
  { date: "2025-10-23", event: "LTX-2 video", org: "Lightricks", color: "#FFB000" },
  { date: "2025-10-27", event: "MiniMax M2", org: "MiniMax", color: "#FF2D55" },
  { date: "2025-10-30", event: "Pelican-VL 1.0", org: "Research community open release", color: "#666666" },
  { date: "2025-12-01", event: "DeepSeek V3.2", org: "DeepSeek", color: "#003366" },
  { date: "2025-12-10", event: "Devstral 2", org: "Mistral AI", color: "#E0002A" },
  { date: "2025-12-15", event: "Nemotron 3", org: "NVIDIA", color: "#76B900" },
  { date: "2025-12-25", event: "Devstral releases", org: "Mistral AI", color: "#E0002A" },
  { date: "2028-12-02", event: "Mistral 3 family", org: "Mistral AI", color: "#E0002A" }
];

let state = { k: DATA.length, timer: null, playing: false };
const svg = d3.select("#timeline-svg");
const container = document.getElementById("chart-container");

function render() {
  const rect = container.getBoundingClientRect();
  const width = rect.width || 800;
  const height = rect.height || 600;
  const margin = { left: 70, right: 70, top: 120, bottom: 120 };

  svg.attr("width", width).attr("height", height).selectAll("*").remove();

  const parseTime = d3.utcParse("%Y-%m-%d");
  const data = DATA.map(d => ({ ...d, dateObj: parseTime(d.date) })).sort((a,b) => a.dateObj - b.dateObj);
  const visibleData = data.slice(0, state.k);

  const x = d3.scaleUtc()
    .domain(d3.extent(data, d => d.dateObj))
    .range([margin.left, width - margin.right]);

  // Center Axis
  svg.append("line")
    .attr("x1", margin.left)
    .attr("x2", width - margin.right)
    .attr("y1", height / 2)
    .attr("y2", height / 2)
    .attr("stroke", "#e5e7eb")
    .attr("stroke-width", 2);

  visibleData.forEach((d, i) => {
    const isUp = i % 2 === 0;
    let tickLen = 60;
    
    // Dynamic height staggering to prevent label overlap
    for (let j = i - 1; j >= Math.max(0, i-4); j--) {
        const dx = Math.abs(x(d.dateObj) - x(data[j].dateObj));
        if (dx < 90) tickLen += 40; 
    }

    const y = isUp ? (height / 2) - tickLen : (height / 2) + tickLen;

    // Ticks
    svg.append("line")
      .attr("x1", x(d.dateObj)).attr("x2", x(d.dateObj))
      .attr("y1", height / 2).attr("y2", y)
      .attr("stroke", "#d1d5db").attr("stroke-dasharray", "3,3");

    // Nodes
    svg.append("circle")
      .attr("cx", x(d.dateObj)).attr("cy", height / 2).attr("r", 5)
      .attr("fill", d.color).attr("stroke", "#fff").attr("stroke-width", 2);

    // Event Text
    svg.append("text")
      .attr("x", x(d.dateObj)).attr("y", isUp ? y - 10 : y + 20)
      .attr("text-anchor", "middle").attr("fill", d.color)
      .attr("font-size", "12px").attr("font-weight", "700")
      .text(d.event);

    // Org Name
    svg.append("text")
      .attr("x", x(d.dateObj)).attr("y", isUp ? y - 24 : y + 34)
      .attr("text-anchor", "middle").attr("fill", "#9ca3af")
      .attr("font-size", "10px")
      .text(d.org);

    // Date Label
    svg.append("text")
      .attr("x", x(d.dateObj)).attr("y", isUp ? (height / 2) + 20 : (height / 2) - 10)
      .attr("text-anchor", "middle").attr("font-size", "11px").attr("fill", "#4b5563")
      .text(d3.utcFormat("%b %d")(d.dateObj));
  });
}

// Controls logic
document.getElementById("btnPlay").onclick = function() {
  if(state.playing) {
    clearInterval(state.timer);
    state.playing = false;
    this.textContent = "Play";
    this.classList.add("btn-active");
  } else {
    if(state.k >= DATA.length) state.k = 0;
    state.playing = true;
    this.textContent = "Pause";
    this.classList.remove("btn-active");
    state.timer = setInterval(() => {
      if(state.k < DATA.length) { state.k++; render(); }
      else { clearInterval(state.timer); state.playing = false; this.textContent = "Play"; this.classList.add("btn-active"); }
    }, 500);
  }
};

document.getElementById("btnReset").onclick = () => { state.k = 0; render(); };

// Resize handling
const observer = new ResizeObserver(() => render());
observer.observe(container);

// PNG Download
document.getElementById("btnDownload").onclick = () => {
    const svgEl = document.getElementById("timeline-svg");
    const serializer = new XMLSerializer();
    const source = serializer.serializeToString(svgEl);
    const canvas = document.createElement("canvas");
    const rect = svgEl.getBoundingClientRect();
    canvas.width = rect.width * 2;
    canvas.height = rect.height * 2;
    const ctx = canvas.getContext("2d");
    const img = new Image();
    img.onload = () => {
        ctx.fillStyle = "white";
        ctx.fillRect(0,0,canvas.width,canvas.height);
        ctx.scale(2,2);
        ctx.drawImage(img,0,0);
        const a = document.createElement("a");
        a.download = "timeline.png";
        a.href = canvas.toDataURL("image/png");
        a.click();
    };
    img.src = "data:image/svg+xml;charset=utf-8," + encodeURIComponent(source);
};

render();
</script>
</body>
</html>